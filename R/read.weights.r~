#' Aggregates yield data to regions
#'
#' Aggregates from the gridcell to the regions in region.map. The
#' function `read.GGCMI.RData()` (or `read.AgMIP.nc` in the previous version
#' of the tool) produces the input to `data2agg`. `read.weights()` produces
#' the data for `weight.map`.
#'
#' @param crop
#' @param weights
#'

read.weights <- function(crop, weights){
    if( !weights %in% c("none", "area", "production") ){
        stop('The weights argument needs to be one of "none", "area", "production"')
        }
    if( weights == "none" ){
        weight.data <- NULL
    }else{

        if( crop %in% c("winter_wheat", "spring_wheat") & weights == "production" ){
            stop("Only area weights are available for winter and spring wheat.")
        }else{
            if(
                crop %in% c("winter_wheat", "spring_wheat") & weights == "area"
            ){
                weight.data.filename <- paste(crop, ".ha.mirca", sep = "")
                data( list = weight.data.filename, envir=environment())
                assign("weight.data",get(weight.data.filename))
            }else{
                weight.unit <- ifelse(weights == "area", "ha", "mt")
                weight.data.filename <- paste(crop, ".", weight.unit, ".monfreda", sep = "")
                data( list = weight.data.filename, envir=environment())
                assign("weight.data",get(weight.data.filename))
            }
        }
    }
    return(weight.data)
}
