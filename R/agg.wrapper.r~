#' Aggregates yield data to regions using specified weights
#'
#' Aggregates from the gridcell to the regions in region.map. The
#' function `read.GGCMI.RData()` (or `read.AgMIP.nc` in the previous version
#' of the tool) produces the input to `data2agg`. `read.weights()` produces
#' the data for `weight.map`.
#'
#' @param datafile
#' @param crop
#' @param regions Current options are are "countries" and
#'     "countriesAEZ18". Default is "countries".
#' @param weights Either NULL (when 'weights' = "none" in
#'     'agg.wrapper()') or the output of 'read.weights()'
#'
#' grid.agg()

agg.wrapper <- function(datafile, crop, regions = "countries", weights){
    weight.map <- read.weights(crop, weights)
    yielddat <- read.GGCMI.RData( datafile = datafile ,crop = crop )
    yielddat.agg <- grid.agg( data2agg = yielddat,
                             region.map= regions,
                             weight.map = weight.map)
    }
